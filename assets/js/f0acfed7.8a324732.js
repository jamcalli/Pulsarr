"use strict";(globalThis.webpackChunk_watchlist_v2_docs=globalThis.webpackChunk_watchlist_v2_docs||[]).push([[3181],{97491(e,r,n){n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"installation/postgres-migration","title":"Migrating from SQLite to PostgreSQL","description":"Migrate your existing Pulsarr SQLite database to PostgreSQL.","source":"@site/docs/installation/postgres-migration.md","sourceDirName":"installation","slug":"/installation/postgres-migration","permalink":"/Pulsarr/docs/installation/postgres-migration","draft":false,"unlisted":false,"editUrl":"https://github.com/jamcalli/pulsarr/edit/main/docs/docs/installation/postgres-migration.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Radarr Configuration","permalink":"/Pulsarr/docs/installation/radarr-configuration"},"next":{"title":"Advanced Content Routing","permalink":"/Pulsarr/docs/features/content-routing"}}');var i=n(74848),t=n(28453);const a={sidebar_position:6},l="Migrating from SQLite to PostgreSQL",o={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Migration Steps",id:"migration-steps",level:2},{value:"1. Create Migration Compose File",id:"1-create-migration-compose-file",level:3},{value:"2. Update SQLite Schema",id:"2-update-sqlite-schema",level:3},{value:"3. Configure PostgreSQL in .env",id:"3-configure-postgresql-in-env",level:3},{value:"4. Setup PostgreSQL Schema",id:"4-setup-postgresql-schema",level:3},{value:"5. Migrate Data",id:"5-migrate-data",level:3},{value:"6. Start Pulsarr",id:"6-start-pulsarr",level:3},{value:"Migration Options",id:"migration-options",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Rollback",id:"rollback",level:2}];function c(e){const r={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"migrating-from-sqlite-to-postgresql",children:"Migrating from SQLite to PostgreSQL"})}),"\n",(0,i.jsx)(r.p,{children:"Migrate your existing Pulsarr SQLite database to PostgreSQL."}),"\n",(0,i.jsx)(r.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Existing Pulsarr installation on SQLite"}),"\n",(0,i.jsx)(r.li,{children:"PostgreSQL server running and accessible"}),"\n",(0,i.jsx)(r.li,{children:"Empty PostgreSQL database created (migration creates tables, not the database)"}),"\n",(0,i.jsx)(r.li,{children:"Database user with ALL PRIVILEGES"}),"\n"]}),"\n",(0,i.jsx)(r.admonition,{title:"Create Database First",type:"warning",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-sql",children:"CREATE DATABASE pulsarr;\nGRANT ALL PRIVILEGES ON DATABASE pulsarr TO your_username;\n"})})}),"\n",(0,i.jsx)(r.h2,{id:"migration-steps",children:"Migration Steps"}),"\n",(0,i.jsx)(r.h3,{id:"1-create-migration-compose-file",children:"1. Create Migration Compose File"}),"\n",(0,i.jsxs)(r.p,{children:["Create ",(0,i.jsx)(r.code,{children:"docker-compose.migration.yml"}),":"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-yaml",children:"services:\n  pulsarr-migrate-sqlite:\n    image: lakker/pulsarr:latest\n    container_name: pulsarr-migrate-sqlite\n    volumes:\n      - ./data:/app/data\n      - .env:/app/.env\n    env_file:\n      - .env\n    profiles:\n      - migration\n    command: bun run migrate\n\n  pulsarr-migrate-postgres-setup:\n    image: lakker/pulsarr:latest\n    container_name: pulsarr-migrate-postgres-setup\n    volumes:\n      - ./data:/app/data\n      - .env:/app/.env\n    env_file:\n      - .env\n    profiles:\n      - migration\n    command: bun run migrate:postgres-setup\n\n  pulsarr-migrate-data:\n    image: lakker/pulsarr:latest\n    container_name: pulsarr-migrate-data\n    volumes:\n      - ./data:/app/data\n      - .env:/app/.env\n    env_file:\n      - .env\n    profiles:\n      - migration\n    stdin_open: true\n    tty: true\n    command: bun run migrate:sqlite-to-postgres\n"})}),"\n",(0,i.jsx)(r.h3,{id:"2-update-sqlite-schema",children:"2. Update SQLite Schema"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"docker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-sqlite\n"})}),"\n",(0,i.jsx)(r.h3,{id:"3-configure-postgresql-in-env",children:"3. Configure PostgreSQL in .env"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-env",children:"dbType=postgres\ndbHost=your-postgres-host\ndbPort=5432\ndbName=pulsarr\ndbUser=postgres\ndbPassword=your-secure-password\n\n# Or use connection string (takes priority):\n# dbConnectionString=postgresql://user:pass@host:port/database\n"})}),"\n",(0,i.jsx)(r.h3,{id:"4-setup-postgresql-schema",children:"4. Setup PostgreSQL Schema"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"docker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-postgres-setup\n"})}),"\n",(0,i.jsx)(r.h3,{id:"5-migrate-data",children:"5. Migrate Data"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:'# Interactive (prompts for confirmation)\ndocker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-data\n\n# Non-interactive (auto-confirm)\necho "y" | docker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-data\n'})}),"\n",(0,i.jsx)(r.p,{children:"The script will:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Verify both database connections"}),"\n",(0,i.jsxs)(r.li,{children:["Create SQLite backup in ",(0,i.jsx)(r.code,{children:"./data/backups/"})]}),"\n",(0,i.jsx)(r.li,{children:"Migrate all data with type conversions"}),"\n",(0,i.jsx)(r.li,{children:"Update PostgreSQL sequences"}),"\n",(0,i.jsx)(r.li,{children:"Verify row counts match"}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"6-start-pulsarr",children:"6. Start Pulsarr"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"docker compose up -d\ndocker compose logs pulsarr  # Verify startup\n"})}),"\n",(0,i.jsx)(r.h2,{id:"migration-options",children:"Migration Options"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Option"}),(0,i.jsx)(r.th,{children:"Description"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"--verbose"})}),(0,i.jsx)(r.td,{children:"Show detailed progress per batch"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"--batch-size=N"})}),(0,i.jsx)(r.td,{children:"Rows per batch (default: 1000)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"--help"})}),(0,i.jsx)(r.td,{children:"Show all options"})]})]})]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:'echo "y" | docker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-data bun run --bun migrations/scripts/sqlite-to-postgresql.ts --verbose\n'})}),"\n",(0,i.jsx)(r.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Error"}),(0,i.jsx)(r.th,{children:"Solution"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Connection failed"})}),(0,i.jsxs)(r.td,{children:["Verify PostgreSQL is running, check ",(0,i.jsx)(r.code,{children:".env"})," settings, test with psql client"]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Permission denied"})}),(0,i.jsx)(r.td,{children:"Ensure user has ALL PRIVILEGES on the database"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Table doesn't exist"})}),(0,i.jsx)(r.td,{children:"Run step 4 (schema setup) before data migration"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Invalid input syntax"})}),(0,i.jsx)(r.td,{children:"Check logs for specific data causing issues"})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"rollback",children:"Rollback"}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsx)(r.li,{children:"Stop Pulsarr"}),"\n",(0,i.jsxs)(r.li,{children:["Update ",(0,i.jsx)(r.code,{children:".env"}),":","\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-env",children:"dbType=sqlite\ndbPath=./data/db/pulsarr.db\n"})}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["Restore from ",(0,i.jsx)(r.code,{children:"./data/backups/"})," if needed"]}),"\n",(0,i.jsx)(r.li,{children:"Start Pulsarr"}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);