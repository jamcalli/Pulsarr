"use strict";(self.webpackChunk_watchlist_v2_docs=self.webpackChunk_watchlist_v2_docs||[]).push([[3181],{63362:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"installation/postgres-migration","title":"Migrating from SQLite to PostgreSQL","description":"Pulsarr supports both SQLite and PostgreSQL databases. This guide will help you migrate your existing SQLite data to PostgreSQL.","source":"@site/docs/installation/postgres-migration.md","sourceDirName":"installation","slug":"/installation/postgres-migration","permalink":"/Pulsarr/docs/installation/postgres-migration","draft":false,"unlisted":false,"editUrl":"https://github.com/jamcalli/pulsarr/edit/main/docs/docs/installation/postgres-migration.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Configuration","permalink":"/Pulsarr/docs/installation/configuration"},"next":{"title":"Advanced Content Routing","permalink":"/Pulsarr/docs/features/content-routing"}}');var r=s(74848),t=s(28453);const a={sidebar_position:3},o="Migrating from SQLite to PostgreSQL",l={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Migration Process",id:"migration-process",level:2},{value:"Step 1: Prepare Migration Files",id:"step-1-prepare-migration-files",level:3},{value:"Step 2: Update SQLite Schema",id:"step-2-update-sqlite-schema",level:3},{value:"Step 3: Configure PostgreSQL Settings",id:"step-3-configure-postgresql-settings",level:3},{value:"Option A: Individual Parameters",id:"option-a-individual-parameters",level:4},{value:"Option B: Connection String",id:"option-b-connection-string",level:4},{value:"Step 4: Setup PostgreSQL Schema",id:"step-4-setup-postgresql-schema",level:3},{value:"Step 5: Migrate Your Data",id:"step-5-migrate-your-data",level:3},{value:"Non-Interactive Migration",id:"non-interactive-migration",level:4},{value:"Migration Command Options",id:"migration-command-options",level:4},{value:"Step 6: Verify Migration",id:"step-6-verify-migration",level:3},{value:"Step 7: Start Pulsarr",id:"step-7-start-pulsarr",level:3},{value:"Environment Variables Reference",id:"environment-variables-reference",level:2},{value:"Database Type",id:"database-type",level:3},{value:"Individual Connection Parameters",id:"individual-connection-parameters",level:3},{value:"Connection String",id:"connection-string",level:3},{value:"Advanced Usage",id:"advanced-usage",level:2},{value:"Automation and CI/CD",id:"automation-and-cicd",level:3},{value:"Performance Tuning",id:"performance-tuning",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Connection Issues",id:"connection-issues",level:3},{value:"Permission Issues",id:"permission-issues",level:3},{value:"Schema Mismatch",id:"schema-mismatch",level:3},{value:"Data Type Issues",id:"data-type-issues",level:3},{value:"Rollback",id:"rollback",level:2},{value:"Post-Migration Notes",id:"post-migration-notes",level:2}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"migrating-from-sqlite-to-postgresql",children:"Migrating from SQLite to PostgreSQL"})}),"\n",(0,r.jsx)(n.p,{children:"Pulsarr supports both SQLite and PostgreSQL databases. This guide will help you migrate your existing SQLite data to PostgreSQL."}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"Before starting the migration, ensure you have:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Existing Pulsarr installation"})," running on SQLite"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"PostgreSQL server"})," running and accessible"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"PostgreSQL database created"})," - You must manually create an empty database (e.g., ",(0,r.jsx)(n.code,{children:"pulsarr"}),") before migration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Database user with permissions"})," - Ensure the user has CREATE, INSERT, UPDATE, DELETE, and DROP privileges on the database"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Database backup"})," (the migration script creates one automatically, but having your own is recommended)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Network access"})," from Pulsarr container to PostgreSQL database"]}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{title:"Create Database First",type:"warning",children:[(0,r.jsxs)(n.p,{children:["You must create an empty PostgreSQL database before running the migration. The migration script will create tables and migrate data, but it will ",(0,r.jsx)(n.strong,{children:"not"})," create the database itself."]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Example: Connect to PostgreSQL and create database\nCREATE DATABASE pulsarr;\n-- Grant permissions to your user\nGRANT ALL PRIVILEGES ON DATABASE pulsarr TO your_username;\n"})})]}),"\n",(0,r.jsx)(n.h2,{id:"migration-process",children:"Migration Process"}),"\n",(0,r.jsx)(n.p,{children:"The migration involves three main steps:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Update SQLite"})," to the latest schema"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Setup PostgreSQL"})," with the same schema"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Migrate data"})," from SQLite to PostgreSQL"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-1-prepare-migration-files",children:"Step 1: Prepare Migration Files"}),"\n",(0,r.jsx)(n.p,{children:"Download the migration compose file:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Create the migration compose file\ncat > docker-compose.migration.yml << 'EOF'\nservices:\n  # Step 1: Update SQLite to latest migrations\n  pulsarr-migrate-sqlite:\n    image: lakker/pulsarr:latest\n    container_name: pulsarr-migrate-sqlite\n    volumes:\n      - ./data:/app/data\n      - .env:/app/.env\n    env_file:\n      - .env\n    profiles:\n      - migration\n    command: npm run migrate\n\n  # Step 2: Setup PostgreSQL schema  \n  pulsarr-migrate-postgres-setup:\n    image: lakker/pulsarr:latest\n    container_name: pulsarr-migrate-postgres-setup\n    volumes:\n      - ./data:/app/data\n      - .env:/app/.env\n    env_file:\n      - .env\n    profiles:\n      - migration\n    command: npm run migrate:postgres-setup\n\n  # Step 3: Migrate data from SQLite to PostgreSQL\n  pulsarr-migrate-data:\n    image: lakker/pulsarr:latest\n    container_name: pulsarr-migrate-data\n    volumes:\n      - ./data:/app/data\n      - .env:/app/.env\n    env_file:\n      - .env\n    profiles:\n      - migration\n    stdin_open: true\n    tty: true\n    command: npm run migrate:sqlite-to-postgres\nEOF\n"})}),"\n",(0,r.jsx)(n.h3,{id:"step-2-update-sqlite-schema",children:"Step 2: Update SQLite Schema"}),"\n",(0,r.jsx)(n.p,{children:"Ensure your SQLite database is on the latest migration:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# This runs with your current SQLite settings\ndocker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-sqlite\n"})}),"\n",(0,r.jsx)(n.h3,{id:"step-3-configure-postgresql-settings",children:"Step 3: Configure PostgreSQL Settings"}),"\n",(0,r.jsxs)(n.p,{children:["Update your ",(0,r.jsx)(n.code,{children:".env"})," file with PostgreSQL configuration. You can use either individual connection parameters or a connection string."]}),"\n",(0,r.jsx)(n.h4,{id:"option-a-individual-parameters",children:"Option A: Individual Parameters"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"# Database Configuration\ndbType=postgres\ndbHost=your-postgres-host\ndbPort=5432\ndbName=pulsarr\ndbUser=postgres\ndbPassword=your-secure-password\n"})}),"\n",(0,r.jsx)(n.h4,{id:"option-b-connection-string",children:"Option B: Connection String"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"# Database Configuration\ndbType=postgres\ndbConnectionString=postgresql://username:password@host:port/database\n\n# Example:\n# dbConnectionString=postgresql://postgres:mypassword@localhost:5432/pulsarr\n# dbConnectionString=postgresql://user:pass@postgres.example.com:5432/pulsarr_db\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"Connection Priority",type:"info",children:(0,r.jsxs)(n.p,{children:["If both ",(0,r.jsx)(n.code,{children:"dbConnectionString"})," and individual parameters are provided, the connection string takes priority."]})}),"\n",(0,r.jsx)(n.h3,{id:"step-4-setup-postgresql-schema",children:"Step 4: Setup PostgreSQL Schema"}),"\n",(0,r.jsx)(n.p,{children:"Create the database schema in PostgreSQL:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# This runs with your new PostgreSQL settings\ndocker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-postgres-setup\n"})}),"\n",(0,r.jsx)(n.h3,{id:"step-5-migrate-your-data",children:"Step 5: Migrate Your Data"}),"\n",(0,r.jsx)(n.p,{children:"Run the data migration script:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Interactive mode (will prompt for confirmation before proceeding)\ndocker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-data\n"})}),"\n",(0,r.jsx)(n.h4,{id:"non-interactive-migration",children:"Non-Interactive Migration"}),"\n",(0,r.jsx)(n.p,{children:"For automated deployments or if you want to skip the confirmation prompt:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Auto-confirm migration (non-interactive)\necho "y" | docker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-data\n'})}),"\n",(0,r.jsx)(n.h4,{id:"migration-command-options",children:"Migration Command Options"}),"\n",(0,r.jsx)(n.p,{children:"You can pass additional options to the migration script:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Show help and available options\ndocker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-data npx tsx migrations/scripts/sqlite-to-postgresql.ts --help\n\n# Verbose output (shows detailed progress for each batch)\necho "y" | docker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-data npx tsx migrations/scripts/sqlite-to-postgresql.ts --verbose\n\n# Custom batch size (default: 1000 rows per batch)\necho "y" | docker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-data npx tsx migrations/scripts/sqlite-to-postgresql.ts --batch-size=500\n'})}),"\n",(0,r.jsx)(n.p,{children:"The script will:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Verify connections to both databases"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Create a backup of your SQLite database"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Show migration summary and ask for confirmation (unless auto-confirmed)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Migrate all data with proper type conversions"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Update PostgreSQL auto-increment sequences"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Verify migration completed successfully"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-6-verify-migration",children:"Step 6: Verify Migration"}),"\n",(0,r.jsx)(n.p,{children:"After migration completes successfully, verify everything migrated correctly:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Check the migration output"})," - Look for:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'\u2705 "All row counts match!"'}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Total number of migrated rows"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Backup location"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Verify your .env configuration"})," - Ensure PostgreSQL settings are active:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"dbType=postgres\n# Your PostgreSQL connection settings should be uncommented/active\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-7-start-pulsarr",children:"Step 7: Start Pulsarr"}),"\n",(0,r.jsx)(n.p,{children:"Once migration is verified, start Pulsarr normally:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"docker compose up -d\n"})}),"\n",(0,r.jsx)(n.p,{children:"Pulsarr will now use your PostgreSQL database!"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"First startup verification:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Check the logs: ",(0,r.jsx)(n.code,{children:"docker compose logs pulsarr"})]}),"\n",(0,r.jsx)(n.li,{children:"Verify the web interface loads correctly"}),"\n",(0,r.jsx)(n.li,{children:"Test a few key functions (viewing watchlists, checking settings)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"environment-variables-reference",children:"Environment Variables Reference"}),"\n",(0,r.jsx)(n.h3,{id:"database-type",children:"Database Type"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"dbType"})," - Set to ",(0,r.jsx)(n.code,{children:"postgres"})," for PostgreSQL"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"individual-connection-parameters",children:"Individual Connection Parameters"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"dbHost"})," - PostgreSQL server hostname (default: ",(0,r.jsx)(n.code,{children:"localhost"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"dbPort"})," - PostgreSQL server port (default: ",(0,r.jsx)(n.code,{children:"5432"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"dbName"})," - Database name (default: ",(0,r.jsx)(n.code,{children:"pulsarr"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"dbUser"})," - Database username (default: ",(0,r.jsx)(n.code,{children:"postgres"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"dbPassword"})," - Database password (default: ",(0,r.jsx)(n.code,{children:"pulsarrpostgrespw"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"connection-string",children:"Connection String"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"dbConnectionString"})," - Full PostgreSQL connection string (optional)"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"advanced-usage",children:"Advanced Usage"}),"\n",(0,r.jsx)(n.h3,{id:"automation-and-cicd",children:"Automation and CI/CD"}),"\n",(0,r.jsx)(n.p,{children:"For automated deployments, you can run the entire migration process non-interactively:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Complete automated migration\necho "y" | docker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-data\n\n# With verbose logging for automation monitoring\necho "y" | docker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-data npx tsx migrations/scripts/sqlite-to-postgresql.ts --verbose\n'})}),"\n",(0,r.jsx)(n.h3,{id:"performance-tuning",children:"Performance Tuning"}),"\n",(0,r.jsx)(n.p,{children:"For large databases, you may want to adjust the batch size:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Smaller batches for memory-constrained environments\necho "y" | docker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-data npx tsx migrations/scripts/sqlite-to-postgresql.ts --batch-size=500\n\n# Larger batches for faster migration (more memory usage)\necho "y" | docker compose -f docker-compose.migration.yml --profile migration run --rm pulsarr-migrate-data npx tsx migrations/scripts/sqlite-to-postgresql.ts --batch-size=2000\n'})}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"connection-issues",children:"Connection Issues"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Error: Database connection failed"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Verify PostgreSQL is running and accessible"}),"\n",(0,r.jsxs)(n.li,{children:["Check your connection settings in ",(0,r.jsx)(n.code,{children:".env"})]}),"\n",(0,r.jsx)(n.li,{children:"Ensure firewall allows connections on the specified port"}),"\n",(0,r.jsx)(n.li,{children:"Test connection with a PostgreSQL client first"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"permission-issues",children:"Permission Issues"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Error: Permission denied"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Ensure the database user has CREATE, INSERT, UPDATE, DELETE permissions"}),"\n",(0,r.jsx)(n.li,{children:"For initial setup, the user may need additional privileges to create tables"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"schema-mismatch",children:"Schema Mismatch"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Error: Table doesn't exist"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Make sure you ran Step 4 (PostgreSQL schema setup) before data migration"}),"\n",(0,r.jsx)(n.li,{children:"Verify both databases are on the same migration version"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"data-type-issues",children:"Data Type Issues"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Error: Invalid input syntax"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The migration script handles most type conversions automatically"}),"\n",(0,r.jsx)(n.li,{children:"If you encounter issues, check the logs for specific data that's causing problems"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"rollback",children:"Rollback"}),"\n",(0,r.jsx)(n.p,{children:"If you need to rollback to SQLite:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Stop Pulsarr"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Update ",(0,r.jsx)(n.code,{children:".env"})]})," to use SQLite settings:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"dbType=sqlite\ndbPath=./data/db/pulsarr.db\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Restore from backup"})," if needed (located in ",(0,r.jsx)(n.code,{children:"./data/backups/"}),")"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Start Pulsarr"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"post-migration-notes",children:"Post-Migration Notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Backup location"}),": Automatic SQLite backup is created in ",(0,r.jsx)(n.code,{children:"./data/backups/"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Monitoring"}),": Check logs after migration to ensure everything is working correctly"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cleanup"}),": You can safely delete the SQLite backup after confirming PostgreSQL works correctly"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);